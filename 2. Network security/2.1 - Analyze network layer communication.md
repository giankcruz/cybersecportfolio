# Networks and network security

In the internet layer of the TCP/IP model, IP is responsible for formatting data packets into IP datagrams. The information contained in the datagram of an IP packet can provide valuable insight into potentially suspicious packets in transit.

Knowing how to identify potentially malicious traffic on a network helps to assess security risks and strengthen network protection. In this activity, DNS and ICMP traffic in transit will be analyzed based on data obtained from a network protocol analysis tool, identifying the network protocol used to evaluate the cybersecurity incident. 

Both the website and the information presented are fictitious.

## Scenario

You are a cybersecurity analyst working at a company that specializes in providing IT services for clients. Several customers of clients reported that they were not able to access the client company website www.yummyrecipesforme.com, and saw the error “destination port unreachable” after waiting for the page to load. 

You are tasked with analyzing the situation and determining which network protocol was affected during this incident. To start, you attempt to visit the website and you also receive the error “destination port unreachable.” To troubleshoot the issue, you load your network analyzer tool, tcpdump, and attempt to load the webpage again. To load the webpage, your browser sends a query to a DNS server via the UDP protocol to retrieve the IP address for the website's domain name; this is part of the DNS protocol. Your browser then uses this IP address as the destination IP for sending an HTTPS request to the web server to display the webpage  The analyzer shows that when you send UDP packets to the DNS server, you receive ICMP packets containing the error message: “udp port 53 unreachable.” 

![googlesec](https://raw.githubusercontent.com/giankcruz/cybersecportfolio/3dea6875987848f2921ff5e5e8772aa36c3826ef/network%20layer.png)

In the tcpdump log, you find the following information:

1. The first two log lines show your computer sending a UDP request to the DNS server for the IP address of yummyrecipesforme.com.
2. The third and fourth log lines show the response to your UDP packet; the ICMP 203.0.113.2 line begins the error message that the UDP packet was undeliverable to port 53 on the DNS server.
3. Each request and response includes a timestamp, such as 13:24:32.192571, indicating the exact time the incident occurred (1:24 p.m., 32.192571 seconds).
4. After the timestamps, you’ll see the source and destination IP addresses The IP before the “>” is the source (your computer), and the one after is the destination (DNS server). In the ICMP error response, the source is 203.0.113.2 and the destination is your computer’s IP, 192.51.100.15.
6. After the source and destination IPs, other details like protocol, source port, and flags may appear. The error log’s first line shows the query ID (e.g., 35084), with a plus sign indicating flags for the UDP message. "A?" refers to a DNS A record request, mapping a domain to an IP. The third line shows the response protocol ("ICMP") and the following ICMP error message.
7. The error "udp port 53 unreachable" means that the DNS request for "www.yummyrecipesforme.com" failed because no service was listening on port 53. The log also shows that two more ICMP packets were sent, but the same error occurred each time.

After capturing data packets with a network analyzer, identify the affected network protocol and service, then write a follow-up report.

## Summary of the problem found in the tcpdump log

During the log analysis, the UDP protocol was used for the DNS query, in addition to ICMP, which was used to report the error on port 53.

The log indicates that my device with IP address 192.51.100.15 attempted to query the IP of the website “yummyrecipesforme.com” by sending UDP packets to the DNS server (with IP 203.0.113.2) on port 53.

The server responds with an ICMP message indicating that port 53 is _unreachable_, meaning that the DNS query cannot be processed because the UDP port is inaccessible or there is no active service listening on that port, a pattern that recurs at different times in the log.

Since the DNS query receives an ICMP message as a response instead of a useful answer, it is understood that the DNS requests cannot be resolved and the website fails to load from the very start of the name resolution process.

## Analysis of the data and solution to implement 

##### Report, symptoms, and current status of the problem
   - According to the TCPdump timestamp, the first recorded failed attempt occurred at 1:24pm and 32 seconds.
   - The issue was reported after a user received a "destination port unreachable" message from the server when trying to access the website.
   - All DNS queries to server 203.0.113.2 return the same ICMP error; none can be processed.

##### Discovered information
   - The problem is described as an inability to interact with the DNS service on the indicated server, possibly due to port 53 being down, blocked by a firewall, or misconfigured.
   - The presence of ICMP traffic indicates that the server is responding, but only to signal the failure.

##### Troubleshooting and resolving the issue
   - Verify that the DNS service is running on server 203.0.113.2.
   - Confirm that UDP port 53 is not blocked by a firewall or network filtering mechanisms.
   - Review the DNS server logs to detect errors, crashes, or misconfigurations.
   - Ensure that the network infrastructure properly allows UDP traffic to and from port 53 on the server.

##### Suspected root cause
   - The DNS service on UDP port 53 of the server is down, not running, or filtered/blocked by a firewall rule, so it does not respond to queries and sends back an ICMP “port unreachable” message.
   - A possible cause being considered is a DDoS amplification attack, which involves sending small DNS queries to the server’s IP address that generate much larger responses than the original request, saturating the bandwidth and causing the DNS service to crash.


As a conclusion and recommendation, it is necessary to verify and restore the DNS service on UDP port 53 on the affected server, checking both the service process and the network configuration (including firewalls and filtering rules), in order to reestablish name resolution and web access.
